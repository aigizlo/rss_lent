# Обновление системы для поддержки изображений

## Описание изменений

Добавлена поддержка парсинга и отображения изображений из RSS лент новостей. Теперь изображения извлекаются из различных полей RSS (media_content, media_thumbnail, enclosures) и HTML-контента статей.

## Внесенные изменения

### 1. База данных
- Добавлено поле `image_url` в таблицу `articles` для хранения URL изображений
- Создан миграционный скрипт `add_image_url_migration.sql`

### 2. Backend (app.py)
- Обновлена модель `Article` с полем `image_url`
- Улучшена функция `fetch_rss_feed()` для извлечения изображений из RSS
- Добавлена поддержка различных форматов RSS изображений
- Обновлен метод `to_dict()` для включения `image_url` в API ответы

### 3. Frontend
- Обновлены HTML шаблоны для отображения изображений:
  - `index.html` - главная страница
  - `category.html` - страница категории
  - `article.html` - страница статьи
- Добавлены CSS стили для корректного отображения изображений
- Реализована адаптивная сетка для статей с изображениями и без них

## Инструкции по обновлению

### 1. Обновление базы данных

Выполните миграционный скрипт для добавления поля image_url:

```bash
# Подключитесь к базе данных PostgreSQL
psql -U your_username -d news_aggregator

# Выполните миграцию
\i add_image_url_migration.sql
```

Или через командную строку:
```bash
psql -U your_username -d news_aggregator -f add_image_url_migration.sql
```

### 2. Перезапуск приложения

После обновления базы данных перезапустите приложение:
```bash
python app.py
```

### 3. Обновление существующих новостей

После запуска приложения выполните ручное обновление новостей для получения изображений:
- Перейдите на главную страницу
- Нажмите кнопку "Обновить" в навигации
- Или используйте API: `GET /api/update`

## Функциональность

### Парсинг изображений

Система теперь ищет изображения в следующих местах RSS ленты:
1. Media RSS namespace (`media_content`)
2. Media thumbnails (`media_thumbnail`)  
3. Enclosures с типом изображения
4. HTML контент статьи (теги `<img>`)

### Отображение изображений

- **Главная страница**: Изображения отображаются слева от текста статьи (адаптивная сетка)
- **Страница категории**: Аналогично главной странице
- **Страница статьи**: Большое изображение над текстом статьи
- **Fallback**: Если изображение не загружается, оно автоматически скрывается

### CSS стили

Добавлены стили для:
- `.article-image` - миниатюры на главной и страницах категорий
- `.article-main-image` - основное изображение на странице статьи
- `.article-image-container` - контейнер с анимациями hover

## Совместимость

- Обновление полностью обратно совместимо
- Существующие статьи без изображений отображаются как раньше
- Новые статьи автоматически получают изображения при парсинге

## API изменения

Поле `image_url` добавлено в JSON ответы всех API эндпоинтов:
- `/api/news`
- `/api/news/<category_name>`

Пример ответа:
```json
{
  "id": 1,
  "title": "Заголовок новости",
  "description": "Описание...",
  "link": "https://...",
  "image_url": "https://example.com/image.jpg",
  "published_at": "2024-01-01T12:00:00",
  "category": "technology",
  "category_display": "IT Технологии",
  "source": "TechCrunch",
  "view_count": 5
}
```
